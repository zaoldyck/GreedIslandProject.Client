<!-- tag-select-dialog.html -->

<h2 mat-dialog-title>
  <mat-icon style="vertical-align: middle; margin-right: 6px;">local_offer</mat-icon>
  选择标签类型
</h2>

<div mat-dialog-content class="content">
  <!-- 加载态（如果你有 isLoading 信号/变量，可以加上 @if） -->
  @if (tagTypes().length === 0) {
  <div class="empty">
    <mat-icon color="accent">info</mat-icon>
    <span>暂无标签类型</span>
  </div>
  } @else {
  <div class="tag-grid">
    @for (t of tagTypes(); track t.id) {
    <button mat-stroked-button
            color="primary"
            [class.active]="isSelected(t)"
            (click)="toggle(t)">
      <mat-icon *ngIf="isSelected(t)" style="margin-right:4px">check</mat-icon>
      {{ t.name }}
    </button>
    }
  </div>

  <!-- 可选：已选预览 chips -->
  @if (selected().length > 0) {
  <div class="selected-preview">
    <div class="caption">已选择：</div>
    <mat-chip-listbox>
      @for (t of selected(); track t.id) {
      <mat-chip-row [removable]="true" (removed)="toggle(t)">
        {{ t.name }}
        <button matChipRemove aria-label="移除">
          <mat-icon>close</mat-icon>
        </button>
      </mat-chip-row>
      }
    </mat-chip-listbox>
  </div>
  }
  }
</div>

<div mat-dialog-actions align="end">
  <button mat-button (click)="clear()">清空</button>
  <button mat-button (click)="cancel()">取消</button>
  <button mat-flat-button color="primary" (click)="confirm()">确定</button>
</div>
